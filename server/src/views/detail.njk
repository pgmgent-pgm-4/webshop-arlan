<!DOCTYPE html>
<html lang="en">
 <head>
  <base href="../">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/main.css">
  <title>Document</title>
 </head>
 <body>
  {% include "./partials/detailheader.njk" %}
  <main>
   <section class="bg-site-bg py-8">
    <div class="flex justify-around mx-auto container">
     <div class="chart__container w-3/4 bg-white text-gray-800 p-5 rounded-2xl shadow-card">
      <h2 class="text-2xl w-full font-extrabold">{{ detailData.name }} rate</h2>
      <p class="w-full font-bold text-3xl pt-1">€{{ detailData.market_data.current_price.eur | round(5) }}</p>
      <p class="w-full text-sm mb-3 text-red-500 {{ 'text-green-500' if detailData.market_data.price_change_percentage_24h > 0 }}">{{ '+' if detailData.market_data.price_change_percentage_24h > 0 }}{{ detailData.market_data.price_change_percentage_24h | round(2) }}% in the past 24 hours</p>
      <canvas style="position: relative; height:45vh; width:100%" id="{{ detailData.id }}Chart"></canvas>
     </div>
     <div class="flex flex-col ml-5 w-1/3 bg-white text-gray-800 p-5 rounded-2xl shadow-card">
      <h2 class="text-2xl w-full font-extrabold">About {{ detailData.name }}</h2>
      <p>{{ detailData.description.en.slice(0, 500) | safe }}...
       <a class="text-blue-500" href="{{ detailData.links.homepage[0] }}">Learn more</a>
      </p>
     </div>
    </div>
   </section>
   <section class="bg-site-bg overflow-hidden py-8">
    <h2 class="text-xl  w-full text-left md:text-center md:text-3xl lg:text-4xl font-bold pt-8 pb-2">More Cryptocurrencies like {{ detailData.name }}</h2>
    <div class="container mx-auto flex flex-wrap py-10">
     <div class="flex w-full justify-between">
      <p class="uppercase font-bold ml-3">name</p>
      <div class="flex">
       <p class="uppercase mr-14 font-bold">price</p>
       <p class="uppercase mr-28 font-bold">change</p>
      </div>
     </div>
     {% for data in tickerData.slice(0, 10) -%}
      <div class="flex flex-wrap items-center justify-between min-w-full bg-white text-gray-800 rounded-2xl mb-3 shadow-card">
       <div class="flex items-center pl-5">
        <div class="flex content-center">
         <img src="{{ data.image }}" class="w-7"/>
         <h3 class="text-lg font-bold ml-3">{{ data.name }}</h3>
        </div>
        <h3 class="text-sm ml-2 font-bold uppercase">{{ data.symbol }}</h3>
       </div>
       <div class="flex items-center">
        <div class="flex justify-evenly items-center">
         <p class="font-bold mr-12 text-xl text-right">€{{ data.current_price | round(5) }}</p>
         <p class="w-20 text-xl mr-12 text-red-500 text-right {{ 'text-green-500' if data.price_change_percentage_24h > 0 }}">{{ '+' if data.price_change_percentage_24h > 0 }}{{ data.price_change_percentage_24h | round(2) }}%</p>
         <a href="detail/{{ data.id }}" class="bg-site-primary hover:bg-blue-700 text-white font-bold py-4 px-4 rounded-r-2xl">
          Buy
         </a>
        </div>
       </div>
      </div>
     {%- endfor %}
    <a href="../../overview" class="bg-site-primary hover:bg-blue-700 text-white m-auto mt-16 font-bold py-4 px-4 rounded-2xl">
     Browse more Cryptocurrencies
    </a>
    </div>
    </section>
  </main>
  {% include "./partials/footer.njk" %}
  <script src="https://kit.fontawesome.com/eefbba8f9b.js" crossorigin="anonymous"></script>
  <script src="scripts/gsap/gsap.min.js" crossorigin="anonymous"></script>
  <script src="scripts/chartjs.js" crossorigin="anonymous"></script>
  <script src="scripts/app.js"></script>
  <script>
   var ctx = document.getElementById('{{ detailData.id }}Chart').getContext('2d');
   const labels = [
    'Monday',
    'Tuesday',
    'Wednesday',
    'Thursday',
    'Friday',
    'Saturday',
    'Sunday'
   ];
   let data = [{{ detailData.market_data.sparkline_7d.price }}];
   data = data.map(result => {
    return result * 0.82;
   });
   var myChart = new Chart(ctx, {
    type: 'line',
    data: {
     labels: labels,
     datasets: [
      {
       data: data,
       backgroundColor: ['rgba(2, 49, 145, 0.3)'],
       borderColor: ['rgb(2, 49, 145)'],
       borderWidth: 1,
       fill: true,
       tension: 0.5
      }
     ]
    },
    options: {
     plugins: {
      legend: {
       display: false
      }
     },
     scales: {
      y: {
       beginAtZero: false
      }
     }
    }
   });
  </script>
 </body>
</html>